"""
Prompt templates for RAG system
"""

# RAG用の質問応答プロンプトテンプレート
RAG_PROMPT_TEMPLATE = """あなたは資料を理解し、正確に回答する専門家アシスタントです。

以下のコンテキスト情報を参考に、ユーザーの質問に答えてください。
回答内容はステップバイステップで考えてください。

【コンテキスト】
{context}

【質問】
{question}

【回答の指針】
1.コンテキスト（提供された資料）の情報のみに基づき、質問に対して正確に回答してください。
2.コンテキストに質問への回答や関連情報が一切含まれていない場合にのみ、「提供された資料には、その情報はありません」と回答してください。
3.回答を作成する際は、コンテキストから抽出した情報を「概要」「詳細」「手続きの流れ」のように、内容に応じて適切に分類・整理して説明してください。
4.回答は詳細かつ丁寧になるよう心がけてください。
5.コンテキストに表やグラフのデータがある場合は、その具体的な数値や内容を回答に含めてください。
6.回答に含めた全ての情報は、その情報が記載されている参照元（ページ番号など）を、情報ごとに必ず明記してください。
7.情報を整理する際は、必要に応じて箇条書きと段落を組み合わせて説明してください。
8.コンテキストに専門用語が含まれ、かつその説明がコンテキスト内にある場合は、その説明も加えてください。

回答:"""


# Vision AIによる表解析プロンプト
TABLE_ANALYSIS_PROMPT = """あなたは資料の表を解析する専門家です。
以下の画像はマニュアルに含まれる表です。

以下の情報を抽出してください：

1. **表の構造**
   - 行数と列数
   - ヘッダー行の内容
   - 表のタイトル（あれば）

2. **表の内容**
   - 各セルの主要なデータ
   - 数値データがあれば具体的な値
   - 単位があれば記載

3. **表の意味**
   - この表が示している情報は何か
   - 主要なデータポイントや傾向

検索可能なテキスト形式で出力してください。"""


# Vision AIによるグラフ解析プロンプト
GRAPH_ANALYSIS_PROMPT = """あなたは資料のグラフを解析する専門家です。
以下の画像はマニュアルに含まれるグラフです。

以下の情報を抽出してください：

1. **グラフの種類**
   - 折れ線グラフ、棒グラフ、円グラフ、散布図など

2. **視覚的な特徴**
   - データの傾向（増加、減少、一定など）
   - 特異点や注目すべきポイント

3. **数値データ（重要）**
   - X軸とY軸のラベル・単位
   - グラフ内の具体的なデータポイント（可能な限り）
   - 凡例の内容
   - グラフタイトル

4. **主要な洞察**
   - このグラフから読み取れる重要な情報

JSON形式で構造化して出力してください：
{{
  "graph_type": "...",
  "title": "...",
  "axes": {{"x": "...", "y": "..."}},
  "data_points": [...],
  "insights": "..."
}}"""


def get_rag_prompt(question: str, context: str) -> str:
    """
    RAG用のプロンプトを生成

    Args:
        question: ユーザーの質問
        context: 検索で取得したコンテキスト

    Returns:
        str: 完成したプロンプト
    """
    return RAG_PROMPT_TEMPLATE.format(question=question, context=context)
