"""
Prompt templates for RAG system
"""

# RAG用の質問応答プロンプトテンプレート
RAG_PROMPT_TEMPLATE = """あなたは資料を理解し、正確に回答する専門家アシスタントです。

以下のコンテキスト情報を参考に、ユーザーの質問に答えてください。

【コンテキスト】
{context}

【質問】
{question}

【回答の指針】
1. **詳細かつ丁寧な回答を心がけてください（最低300文字以上）**
2. コンテキストに基づいて正確に回答してください
3. 単なる要約ではなく、以下の構成で説明してください：
   - 概要（何についての質問か）
   - 詳細な説明（法的根拠、手続き、要件など）
   - 背景情報や補足（なぜそのようなルールがあるのか、注意点など）
   - 実務上のポイント（実際に適用する際の注意事項）
4. 表やグラフのデータがある場合は、具体的な数値を含めて説明してください
5. 参照元の情報（ページ番号など）を必ず明記してください
6. 該当箇所が複数ある場合は、箇条書きと段落を組み合わせて説明してください
7. 専門用語を使用する場合は、簡単な説明を付け加えてください
8. コンテキストに情報がない場合のみ「提供された情報では答えられません」と明示してください

回答:"""


# Vision AIによる表解析プロンプト
TABLE_ANALYSIS_PROMPT = """あなたは資料の表を解析する専門家です。
以下の画像はマニュアルに含まれる表です。

以下の情報を抽出してください：

1. **表の構造**
   - 行数と列数
   - ヘッダー行の内容
   - 表のタイトル（あれば）

2. **表の内容**
   - 各セルの主要なデータ
   - 数値データがあれば具体的な値
   - 単位があれば記載

3. **表の意味**
   - この表が示している情報は何か
   - 主要なデータポイントや傾向

検索可能なテキスト形式で出力してください。"""


# Vision AIによるグラフ解析プロンプト
GRAPH_ANALYSIS_PROMPT = """あなたは資料のグラフを解析する専門家です。
以下の画像はマニュアルに含まれるグラフです。

以下の情報を抽出してください：

1. **グラフの種類**
   - 折れ線グラフ、棒グラフ、円グラフ、散布図など

2. **視覚的な特徴**
   - データの傾向（増加、減少、一定など）
   - 特異点や注目すべきポイント

3. **数値データ（重要）**
   - X軸とY軸のラベル・単位
   - グラフ内の具体的なデータポイント（可能な限り）
   - 凡例の内容
   - グラフタイトル

4. **主要な洞察**
   - このグラフから読み取れる重要な情報

JSON形式で構造化して出力してください：
{{
  "graph_type": "...",
  "title": "...",
  "axes": {{"x": "...", "y": "..."}},
  "data_points": [...],
  "insights": "..."
}}"""


def get_rag_prompt(question: str, context: str) -> str:
    """
    RAG用のプロンプトを生成

    Args:
        question: ユーザーの質問
        context: 検索で取得したコンテキスト

    Returns:
        str: 完成したプロンプト
    """
    return RAG_PROMPT_TEMPLATE.format(question=question, context=context)
